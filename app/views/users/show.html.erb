<!-- user show page -->
<%= content_tag(:div, :class => "container-fluid") do %>
	<%= content_tag :div, :class => "row-fluid" do %>
		<%= content_tag :div, :class => "span12-fluid well" do %>
			<%= content_tag :div, :class => "span4" do %>
				<%= content_tag :div, :class => "page-header" do %>
					<%= content_tag :h4 do %>
						<%= content_tag :div, "", :class => "icon-user" %>
						<%= link_to @user.company, user_path( @user ) %>     
						<%= t(:this_is_you) if current_user == @user %>
					<% end # h4 %>
				<% end # page-header %>
			<% end # span4 fluid %>
			<%= content_tag :div, :class => "span4" do %>
				<% done = 1 + (@items.empty? ? 1 : 0) + (@location.valid? ? 1 : 0) %>
				<% left = { } %>
				<% left[:location]= "edit-location-button" unless @location.valid? %>
				<% left[:item] = "new-item-button" if @items.empty? %>
				<%= render "shared/almost_complete", :done => done, :left => left %>
			<% end if current_user == @user # span4 fluid %>
		<% end # span12 well %>
	<% end # row-fluid %>
	<%= content_tag :div, :class => "row-fluid" do %>
		<%= content_tag :div, :class => "span6 well" do %>
			<%= content_tag :div, :class => "page-header" do %>
				<%= t(:items, :scope => [:views, :items, :show]) %>
				<%= link_to( new_item_path, :class => "btn btn-success", :id => "new-item-button" ) do %>
					<%= content_tag(:i, "", :class => "icon-tag icon-white" ) %>
					<%= t(:item, :scope => [:views, :items, :forms, :new]) %>
				<% end if current_user == @user %>
			<% end # page-header %>
			<%= content_tag :dl do %>
				<% @items.each do |item| %>
					<%= content_tag :dt do %>
						<%= content_tag :i, "", :class => "icon-tag" %>
						<%= link_to( item.title, item_path(item) ) %>
					<% end # dt %>
					<%= content_tag :dd do %>
						<%= content_tag :span, :class => "separator" do %>&raquo;<% end %>
						<%= item.description.length > 75 ? item.description[0..74] + "..." : item.description %>
					<% end # dd %>
				<% end # each item %>
			<% end # dl %>
		<% end # span6-fluid well %>
		<%= content_tag :div, :class => "span6 well" do %>
			<%= content_tag :div, :class => "page-header" do %>
				<%= t(:contact_info, :scope => [:views, :users, :show]) %>
				<% if current_user == @user %>
					<%= content_tag(:button, :class => "btn btn-info", :id => "edit-user-button" ) do %>
						<%= content_tag(:i, "", :class => "icon-pencil") %>
						<%= t(:edit_contact_info, :scope => [:views, :users, :show]) %>
					<% end %>
				<% end # if correct_user %>
			<% end # page-header %>
			<%= render "shared/error_messages", :model => @user %>
			<%= content_tag :dl do %>
				<% {:company => "company", :email => "email", :phone => "phone" }.each do |key, val| %>
					<%= content_tag :dt do %>
						<%= val.capitalize %>
					<% end # dt %>
					<%= content_tag :dd do %>
						<%= @user[key].blank? ? t(:unknown) : @user[key] %>
					<% end # dt %>
				<% end # each key %>
			<% end # dl %>
			<%= content_tag :div, :class => "page-header" do %>
				<%= t(:location, :scope => [:views, :locations, :show]) %>
				<% if current_user == @user %>
					<%= content_tag(:button, :class => "btn btn-info", :id => "edit-location-button" ) do %>
						<%= content_tag(:i, "", :class => "icon-pencil") %>
						<%= t(:edit_location, :scope => [:views, :locations, :show]) %>
					<% end %>
				<% end # if correct_user %>
			<% end # page-header %>
			<%= render "locations/partials/show" %>
		<% end # span6-fluid well %>
	<% end # row-fluid %>
<% end # container %>

<% if current_user == @user %>
	<% ['user','location'].each do |type| %>
		<%= content_tag( :div, :class => "ui-dialog-content ui-widget-content", :id => "edit-#{type}-dialog" ) do %>
			<%= render "#{type.pluralize}/partials/edit", :remote => false, :parent => @user, :method => @location.valid? ? "put" : "post" %>
		<% end # dialog div %>
	<% end # each type %>
<% end # if correct user %>
